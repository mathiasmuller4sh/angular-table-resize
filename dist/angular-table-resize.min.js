angular.module("ngTableResize",[]),angular.module("ngTableResize").directive("resizeable",["resizeStorage","$injector",function(e,t){function n(n,i,o){var r=angular.extend(this,{table:i,container:n.container?$(n.container):$(i).parent(),isFirstDrag:!0,mode:void 0,columns:null,ctrlColumns:null,handleColumns:null,resizer:null,cache:null,bindUtilityFunctions:function(e,t,n){void 0!==n.bind&&(n.bind.update=function(){r.cleanUpAll(e),r.initialiseAll(e,t,n)})},watchModeChange:function(e,t,n){n.$watch(function(){return n.mode},function(){r.cleanUpAll(e),r.initialiseAll(e,t,n)})},cleanUpAll:function(e){r.isFirstDrag=!0,r.deleteHandles(e)},resetTable:function(e){$(e).outerWidth("100%"),$(e).find("th").width("auto")},deleteHandles:function(e){$(e).find("th").find(".handle").remove()},initialiseAll:function(t,n,i){r.columns=$(t).find("th"),r.mode=i.mode,r.saveTableSizes=!angular.isDefined(i.saveTableSizes)||i.saveTableSizes;var o=r.getResizer(i,n);o&&(r.resizer=new o(t,r.columns,r.container),r.saveTableSizes&&(r.cache=e.loadTableSizes(t,i.mode)),r.handleColumns=r.resizer.handles(r.columns),r.ctrlColumns=r.resizer.ctrlColumns,r.resizer.setup(),r.setColumnSizes(r.cache),r.handleColumns.each(function(e,n){r.initHandle(t,n)}))},setColumnSizes:function(e){e&&(r.ctrlColumns.each(function(t,n){var i=$(n).attr("id"),o=e[i];$(n).css({width:o})}),r.resizer.onTableReady())},initHandle:function(e,t){var n=$("<div>",{"class":"handle"});$(t).prepend(n);var i=r.resizer.handleMiddleware(n,t);r.bindEventToHandle(e,n,i)},bindEventToHandle:function(e,t,n){$(t).mousedown(function(e){r.isFirstDrag&&(r.resizer.onFirstDrag(n,t),r.resizer.onTableReady(),r.isFirstDrag=!1);var i={};r.resizer.intervene&&(i=r.resizer.intervene.selector(n),i.column=i,i.orgWidth=$(i).width()),e.preventDefault(),$(t).addClass("active"),$("body").addClass("table-resize");var o=e.clientX,s=$(n).width();$(window).mousemove(r.calculateWidthEvent(n,o,s,i)),$(window).one("mouseup",r.unbindEvent(t))})},calculateWidthEvent:function(e,t,n,i){return function(o){var s=o.clientX,a=s-t,l=r.resizer.calculate(n,a);if(!(l<r.getMinWidth(e)||r.resizer.restrict(l))){if(r.resizer.intervene){var u=r.resizer.intervene.calculator(i.orgWidth,a);if(u<r.getMinWidth(i.column))return;if(r.resizer.intervene.restrict(u))return;$(i.column).width(u)}r.resizer.applyWidth(l,$(e))}}},getMinWidth:function(e){return parseInt($(e).css("min-width"))||0},getResizer:function(e,n){try{var i=n.mode?e.mode:"BasicResizer",o=t.get(i);return o}catch(r){return console.error("The resizer "+e.mode+" was not found"),null}},unbindEvent:function(e){return function(){$(e).removeClass("active"),$(window).unbind("mousemove"),$("body").removeClass("table-resize"),r.resizer.onEndDrag(),r.saveColumnSizes()}},saveColumnSizes:function(){r.saveTableSizes&&(r.cache||(r.cache={}),$(columns).each(function(e,t){var n=$(t).attr("id");n&&(r.cache[n]=r.resizer.saveAttr(t))}),e.saveTableSizes(r.table,r.mode,r.cache))}});$(r.table).addClass("resize"),this.initialiseAll(i,o,n),this.bindUtilityFunctions(i,o,n),this.watchModeChange(i,o,n)}return{restrict:"A",controller:n,scope:{mode:"=",saveTableSizes:"=?",bind:"=",container:"@"}}}]),angular.module("ngTableResize").service("resizeStorage",["$window",function(e){function t(e,t){var i=e.attr("id");return i?n+"."+e.attr("id")+"."+t:void console.error("Table has no id",e)}var n="ngColumnResize";this.loadTableSizes=function(n,i){var o=t(n,i),r=e.localStorage.getItem(o);return JSON.parse(r)},this.saveTableSizes=function(n,i,o){var r=t(n,i);if(r){var s=JSON.stringify(o);e.localStorage.setItem(r,s)}}}]),angular.module("ngTableResize").factory("ResizerModel",[function(){function e(e,t,n){this.table=e,this.columns=t,this.container=n,this.handleColumns=this.handles(),this.ctrlColumns=this.ctrlColumns()}return e.prototype.setup=function(){$(this.container).css({overflowX:"hidden"})},e.prototype.onTableReady=function(){$(this.table).outerWidth("100%")},e.prototype.handles=function(){return this.columns},e.prototype.ctrlColumns=function(){return this.handleColumns},e.prototype.onFirstDrag=function(){$(this.ctrlColumns).each(function(e,t){$(t).width($(t).width())})},e.prototype.handleMiddleware=function(e,t){return t},e.prototype.restrict=function(e){return!1},e.prototype.calculate=function(e,t){return e+t},e.prototype.onEndDrag=function(){},e.prototype.saveAttr=function(e){return $(e).outerWidth()},e.prototype.applyWidth=function(e,t){return $(t).width(e)},e}]),angular.module("ngTableResize").factory("BasicResizer",["ResizerModel",function(e){function t(t,r,s){e.call(this,t,r,s),this.ctrlColumns=this.columns,this.intervene={selector:n,calculator:i,restrict:o}}function n(e){return $(e).next()}function i(e,t){return e-t}function o(e){return e<25}return t.prototype=Object.create(e.prototype),t.prototype.setup=function(){$(this.container).css({overflowX:"hidden"})},t.prototype.handles=function(){return $(this.columns).not(":last")},t.prototype.onFirstDrag=function(){$(this.columns).each(function(e,t){$(t).width($(t).width())})},t.prototype.onEndDrag=function(){var e=$(this.table).outerWidth(),t=0;$(this.columns).each(function(n,i){var o=$(i).outerWidth(),r=o/e*100+"%";t+=o/e*100,$(i).css({width:r})})},t.prototype.saveAttr=function(e){return $(e)[0].style.width},t}]),angular.module("ngTableResize").factory("FixedResizer",["ResizerModel",function(e){function t(t,n,i){e.call(this,t,n,i),this.fixedColumn=$(t).find("th").first(),this.bound=!1}return t.prototype=Object.create(e.prototype),t.prototype.setup=function(){$(this.container).css({overflowX:"hidden"}),$(this.columns).first().css({width:"auto"})},t.prototype.handles=function(){return $(this.columns).not(":last")},t.prototype.ctrlColumns=function(){return $(this.columns).not(":first")},t.prototype.onFirstDrag=function(){$(this.ctrlColumns).each(function(e,t){$(t).width($(t).width())})},t.prototype.handleMiddleware=function(e,t){return $(t).next()},t.prototype.restrict=function(e){return this.bound?!(e<this.bound)||($(this.fixedColumn).width("auto"),this.bound=!1,!1):e<this.minWidth||($(this.fixedColumn).width()<=this.minWidth?(this.bound=e,$(this.fixedColumn).width(this.minWidth),!0):void 0)},t.prototype.calculate=function(e,t){return e-t},t}]),angular.module("ngTableResize").factory("OverflowResizer",["ResizerModel",function(e){function t(t,n,i){e.call(this,t,n,i)}return t.prototype=Object.create(e.prototype),t.prototype.setup=function(){$(this.container).css({overflow:"auto"})},t.prototype.onTableReady=function(){$(this.table).width(1)},t}]);